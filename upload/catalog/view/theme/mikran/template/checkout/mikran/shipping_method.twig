<div id="shipping_method_result">
    {% if shipping_methods %}
	<div class="panel panel-info">	    
	    <div class="panel-heading"> <h3 class="panel-title"><i class="fa fa-lg fa-truck" aria-hidden="true"></i> {{ text_shipping_method }}</h3></div>
	    <div class="panel-body font-larger" id="shipping-body">
		{% include "mikran/template/checkout/mikran/_messages.twig" with {'module':'shipping'} %}
		<div class="relative-spinner hidden" id="shipping-progress-spinner">
		    <i class="fa fa-spinner fa-5x fa-spin" aria-hidden="true"></i>
		</div>
		{% for shipping_method in shipping_methods %}
		    <div class="radio">
			{% for quote in shipping_method.quote %}
			    <label>
				<input type="radio" name="shipping_method" value="{{ quote.code }}" {% if quote.code == code %} checked="checked" {% endif %} />
				{{quote.title}} : {{quote.text}}
				{% if quote.code == code %}
				    {{shipping_method.extra_html}}
				{% endif %}
			    </label>
			{% endfor %}
		    </div>
		{% endfor %}

		{#
		<table class="table table-striped table-bordered table-shipping" id="shipping-table" style="_opacity:0.3">
		    <tbody>
			{% for key,shipping_method in shipping_methods %}
			    {% if shipping_method.error %}
				<div class="alert alert-danger alert-dismissible">{{shipping_method.title}} : {{ shipping_method.error }}</div>
			    {% endif %}
			    <tr>
				{% for quote in shipping_method.quote %}
				    <td class="align-middle">
					<div class="radio text-center">
					    <label class="has_error">
						<input type="radio" name="shipping_method" value="{{ quote.code }}" {% if quote.code == code %} checked="checked" {% endif %}/>
					    </label>
					</div>
				    </td>
				    <td class="align-middle">
					<h3><div class="label label-warning">{{quote.text}}</div></h3>
				    </td>
				    <td class="align-middle">
					{{ quote.title }} {% if quote.code==code %}{{shipping_method.extra_html}} {% endif %}
					<div>
					    {% if shipping_method.image %}
						<img src="{{shipping_method.image}}">
					    {% endif %}
					</div>
				    </td>
				{% endfor %}
			{% endfor %}
		    </tbody>
		</table>
		#}
	    </div>
	</div>
    {% endif %}
</div>

<!--
<p><strong>{{ text_comments }}</strong></p>
<p>
    <textarea name="comment" rows="8" class="form-control">{{ comment }}</textarea>
</p>
--!>
<script type="text/javascript">
 $(document).ready(function() {
     $("input[name='shipping_method']").click(function(event) {
         var radioValue = $("input[name='shipping_method']:checked");
	 $.ajax({
	     url: 'index.php?route=checkout/mikran/shipping_method',
	     type: 'post',
	     data: radioValue,
	     dataType: 'html',
	     beforeSend: function(xhr) {
		 $("#shipping-progress-spinner").removeClass("hidden");
		 $("#shipping-body").css("opacity","0.3");
	     },
	     success: function(html) {
		 $("#shipping_method_result").html(html);
		 // Create the event
		 $(document).trigger("update-totals-table");
	     },
	     error: function(xhr, ajaxOptions, thrownError) {
		 alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
             },
	 });
     });
 });
</script>
